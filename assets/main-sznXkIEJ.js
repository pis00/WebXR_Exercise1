(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))u(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const o of t.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&u(o)}).observe(document,{childList:!0,subtree:!0});function r(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function u(e){if(e.ep)return;e.ep=!0;const t=r(e);fetch(e.href,t)}})();document.addEventListener("DOMContentLoaded",()=>{const a=document.getElementById("intro"),l=document.getElementById("start-ar"),r=document.querySelector("a-scene"),u=document.getElementById("debug-panel"),e=document.getElementById("permission-help"),t=document.getElementById("perm-back"),o=document.getElementById("target-guide"),g=document.querySelector("[mindar-image-target]"),M=document.getElementById("paintModelEntity1"),I=document.getElementById("paintModelEntity2"),L=document.getElementById("paintModelEntity3"),i=document.getElementById("model-nav"),p=document.getElementById("prev-model"),E=document.getElementById("next-model"),d=document.getElementById("exit-btn"),n=s=>{console.log("[DEBUG]",s),u&&(u.textContent="[DEBUG] "+s)},w=()=>{e&&(e.style.display="none")},h=()=>{o&&(o.style.display="flex")},B=()=>{o&&(o.style.display="none")};n("Waiting for Start AR…");let f=null;const m=[M,I,L];let c=0;const y=s=>{c=(s+m.length)%m.length,m.forEach((b,O)=>{b&&b.setAttribute("visible",O===c?"true":"false")}),n(`Model changed to ${c+1} / ${m.length}`)},A=()=>{y(c)},v=()=>{m.forEach(s=>{s&&s.setAttribute("visible","false")})},R=()=>y(c-1),x=()=>y(c+1);p&&p.addEventListener("click",R),E&&E.addEventListener("click",x),g?(g.addEventListener("targetFound",()=>{n("TARGET FOUND – tracking active."),B(),f!==null&&(clearTimeout(f),f=null),i&&(i.style.display="flex"),A()}),g.addEventListener("targetLost",()=>{n("Target lost – searching again…"),h(),f=window.setTimeout(()=>{v(),i&&(i.style.display="none")},800)})):n("WARNING: mindar-image-target entity not found in the scene."),t&&a&&t.addEventListener("click",()=>{w(),B(),a.style.display="flex",r&&(r.style.display="none"),d&&(d.style.display="none"),i&&(i.style.display="none"),n("Returned to start screen. Waiting for Start AR…")}),d&&d.addEventListener("click",()=>{location.reload()}),l&&a&&r?l.addEventListener("click",()=>{a.style.display="none",r.style.display="block",d&&(d.style.display="block"),i&&(i.style.display="flex"),y(0),h(),v(),n("AR scene shown. MindAR will auto-start. Point your camera at the postcard / QR."),setTimeout(()=>{window.dispatchEvent(new Event("resize")),n("Forced window resize after showing AR scene.")},100)}):(console.error("Missing start button, intro, or scene element."),n("ERROR: Missing start button, intro, or scene element."))});
